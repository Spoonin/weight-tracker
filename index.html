<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Трекер Веса и Калорий</title>
    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#1a1a2e" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="apple-touch-icon" href="icon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bitter:wght@400;600;700&family=Work+Sans:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="p-4 md:p-8">
    <!-- Settings Modal -->
    <div
      id="settings-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
    >
      <div
        class="glass-white rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-3xl font-bold">Настройки</h2>
          <button
            id="btn-close-settings"
            class="text-gray-500 hover:text-gray-700 text-2xl"
          >
            &times;
          </button>
        </div>

        <div id="settings-content" class="space-y-6">
          <div class="bg-blue-50 rounded-lg p-6">
            <h3 class="font-bold text-lg mb-4">Ваши параметры</h3>
            <div class="grid grid-cols-2 gap-4 text-sm">
              <div>
                <span class="text-gray-600">Текущий вес:</span>
                <strong id="set-current-weight">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Целевой вес:</span>
                <strong id="set-target-weight">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Рост:</span>
                <strong id="set-height">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Возраст:</span>
                <strong id="set-age">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Дата цели:</span>
                <strong id="set-target-date">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Дней осталось:</span>
                <strong id="set-days-left">&mdash;</strong>
              </div>
            </div>
          </div>

          <div class="bg-purple-50 rounded-lg p-6">
            <h3 class="font-bold text-lg mb-4">Расчёты</h3>
            <div class="grid grid-cols-2 gap-4 text-sm">
              <div>
                <span class="text-gray-600">BMR:</span>
                <strong id="set-bmr">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">TDEE:</span>
                <strong id="set-tdee">&mdash;</strong>
              </div>
              <div>
                <span class="text-gray-600">Дневная норма:</span>
                <strong class="text-purple-600" id="set-daily-target"
                  >&mdash;</strong
                >
              </div>
              <div>
                <span class="text-gray-600">Дефицит:</span>
                <strong id="set-deficit">&mdash;</strong>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t">
              <div class="font-semibold mb-2">Макронутриенты:</div>
              <div class="grid grid-cols-3 gap-2 text-sm">
                <div>Белки: <strong id="set-protein">&mdash;</strong></div>
                <div>Жиры: <strong id="set-fats">&mdash;</strong></div>
                <div>Углеводы: <strong id="set-carbs">&mdash;</strong></div>
              </div>
            </div>
          </div>

          <div class="bg-amber-50 rounded-lg p-6">
            <h3 class="font-bold text-lg mb-4">Опасная зона</h3>
            <p class="text-sm text-gray-600 mb-4">
              Сброс настроек приведёт к удалению всех данных и повторному
              прохождению настройки.
            </p>
            <button
              id="btn-reset-settings"
              class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
            >
              Сбросить все настройки
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Onboarding Modal -->
    <div
      id="onboarding-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
    >
      <div
        class="glass-white rounded-2xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      >
        <h2 class="text-3xl font-bold mb-2">Добро пожаловать!</h2>
        <p class="text-gray-600 mb-6">Давайте настроим ваш план похудения</p>

        <form id="onboarding-form" class="space-y-6">
          <div class="space-y-4">
            <h3 class="text-xl font-bold text-purple-600">
              1. Основные данные
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium mb-2"
                  >Текущий вес (кг) *</label
                >
                <input
                  type="number"
                  step="0.1"
                  id="onb-current-weight"
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                  placeholder="82.2"
                  required
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2"
                  >Целевой вес (кг) *</label
                >
                <input
                  type="number"
                  step="0.1"
                  id="onb-target-weight"
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                  placeholder="75.5"
                  required
                />
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="block text-sm font-medium mb-2"
                  >Рост (см) *</label
                >
                <input
                  type="number"
                  id="onb-height"
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                  placeholder="177"
                  required
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2"
                  >Возраст *</label
                >
                <input
                  type="number"
                  id="onb-age"
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                  placeholder="42"
                  required
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Пол *</label>
                <select
                  id="onb-gender"
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                  required
                >
                  <option value="male">Мужчина</option>
                  <option value="female">Женщина</option>
                </select>
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2"
                >Дата цели *</label
              >
              <input
                type="date"
                id="onb-target-date"
                class="w-full px-4 py-3 rounded-lg border border-gray-300 text-lg"
                required
              />
            </div>
          </div>

          <div class="space-y-4">
            <h3 class="text-xl font-bold text-purple-600">
              2. Уровень активности
            </h3>

            <div class="space-y-2">
              <label
                class="flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-purple-400 transition"
              >
                <input
                  type="radio"
                  name="activity"
                  value="1.2"
                  class="mt-1 mr-3"
                  required
                />
                <div>
                  <div class="font-semibold">Минимальная активность</div>
                  <div class="text-sm text-gray-600">
                    Сидячая работа, нет упражнений
                  </div>
                </div>
              </label>

              <label
                class="flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-purple-400 transition"
              >
                <input
                  type="radio"
                  name="activity"
                  value="1.375"
                  class="mt-1 mr-3"
                />
                <div>
                  <div class="font-semibold">Лёгкая активность</div>
                  <div class="text-sm text-gray-600">
                    Лёгкие упражнения 1-3 раза в неделю
                  </div>
                </div>
              </label>

              <label
                class="flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-purple-400 transition"
              >
                <input
                  type="radio"
                  name="activity"
                  value="1.55"
                  class="mt-1 mr-3"
                  checked
                />
                <div>
                  <div class="font-semibold">Умеренная активность</div>
                  <div class="text-sm text-gray-600">
                    Тренировки 3-5 раз в неделю
                  </div>
                </div>
              </label>

              <label
                class="flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-purple-400 transition"
              >
                <input
                  type="radio"
                  name="activity"
                  value="1.725"
                  class="mt-1 mr-3"
                />
                <div>
                  <div class="font-semibold">Высокая активность</div>
                  <div class="text-sm text-gray-600">
                    Интенсивные тренировки 6-7 раз в неделю
                  </div>
                </div>
              </label>

              <label
                class="flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-purple-400 transition"
              >
                <input
                  type="radio"
                  name="activity"
                  value="1.9"
                  class="mt-1 mr-3"
                />
                <div>
                  <div class="font-semibold">Очень высокая активность</div>
                  <div class="text-sm text-gray-600">
                    Физическая работа + интенсивные тренировки
                  </div>
                </div>
              </label>
            </div>
          </div>

          <div id="calculation-preview" class="bg-purple-50 rounded-lg p-6 space-y-3">
            <h3 class="text-xl font-bold text-purple-600">Ваш план</h3>
            <div class="grid grid-cols-2 gap-4 text-sm">
              <div>
                <div class="text-gray-600">Базовый обмен (BMR)</div>
                <div class="text-2xl font-bold" id="preview-bmr">&mdash;</div>
              </div>
              <div>
                <div class="text-gray-600">Расход калорий (TDEE)</div>
                <div class="text-2xl font-bold" id="preview-tdee">&mdash;</div>
              </div>
              <div>
                <div class="text-gray-600">Дневная норма</div>
                <div
                  class="text-2xl font-bold text-purple-600"
                  id="preview-target"
                >
                  &mdash;
                </div>
              </div>
              <div>
                <div class="text-gray-600">Темп похудения</div>
                <div class="text-2xl font-bold" id="preview-rate">&mdash;</div>
              </div>
            </div>
            <div class="text-sm text-gray-600 border-t pt-3 mt-3">
              <strong>Рекомендации по макронутриентам:</strong>
              <div class="grid grid-cols-3 gap-2 mt-2">
                <div>
                  Белки:
                  <span class="font-semibold" id="preview-protein"
                    >&mdash;</span
                  >
                </div>
                <div>
                  Жиры:
                  <span class="font-semibold" id="preview-fats">&mdash;</span>
                </div>
                <div>
                  Углеводы:
                  <span class="font-semibold" id="preview-carbs">&mdash;</span>
                </div>
              </div>
            </div>
          </div>

          <button
            type="submit"
            class="w-full btn-primary text-white font-bold py-4 rounded-lg text-lg"
          >
            Начать отслеживание
          </button>
        </form>
      </div>
    </div>

    <div class="max-w-7xl mx-auto">
      <div class="glass rounded-2xl p-6 md:p-8 mb-6 fade-in">
        <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">
          Трекер Веса и Калорий
        </h1>
        <p class="text-gray-300" id="header-goal"></p>
      </div>

      <div class="glass rounded-2xl p-4 mb-6 fade-in">
        <div class="flex flex-wrap gap-2 items-center justify-between">
          <div id="nav-tabs" class="flex flex-wrap gap-2">
            <div class="nav-tab active" data-tab="dashboard">Дашборд</div>
            <div class="nav-tab" data-tab="weight">Вес</div>
            <div class="nav-tab" data-tab="calories">Калории</div>
            <div class="nav-tab" data-tab="history">История</div>
            <div class="nav-tab" data-tab="export">Экспорт</div>
          </div>
          <button
            id="btn-settings"
            class="text-white hover:text-gray-300 transition px-4 py-2"
          >
            Настройки
          </button>
        </div>
      </div>

      <div id="dashboard-tab" class="fade-in">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
          <div class="glass stat-card rounded-xl p-6">
            <div class="text-gray-300 text-sm mb-2">Текущий вес</div>
            <div class="text-3xl font-bold text-white" id="current-weight">
              &mdash;
            </div>
            <div class="text-gray-400 text-xs mt-1">кг</div>
          </div>
          <div class="glass stat-card rounded-xl p-6">
            <div class="text-gray-300 text-sm mb-2">Цель</div>
            <div
              class="text-3xl font-bold text-emerald-400"
              id="target-weight-display"
            >
              &mdash;
            </div>
            <div class="text-gray-400 text-xs mt-1">кг</div>
          </div>
          <div class="glass stat-card rounded-xl p-6">
            <div class="text-gray-300 text-sm mb-2">Осталось дней</div>
            <div class="text-3xl font-bold text-white" id="days-remaining">
              &mdash;
            </div>
            <div class="text-gray-400 text-xs mt-1" id="target-date-short"></div>
          </div>
          <div class="glass stat-card rounded-xl p-6">
            <div class="text-gray-300 text-sm mb-2">Калории сегодня</div>
            <div class="text-3xl font-bold text-white" id="today-calories">
              0
            </div>
            <div class="text-gray-400 text-xs mt-1" id="calorie-target-label">
              &mdash;
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <div class="glass-white rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">Прогресс веса</h3>
            <div class="chart-container">
              <canvas id="weightChart"></canvas>
            </div>
          </div>
          <div class="glass-white rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">Калории за неделю</h3>
            <div class="chart-container">
              <canvas id="calorieChart"></canvas>
            </div>
          </div>
        </div>

        <div class="glass-white rounded-xl p-6">
          <h3 class="text-xl font-bold mb-4">Сегодня</h3>
          <div class="space-y-4">
            <div>
              <div class="flex justify-between mb-2">
                <span class="text-sm font-medium">Калории</span>
                <span class="text-sm text-gray-600" id="calorie-status"
                  >0 / &mdash; ккал</span
                >
              </div>
              <div class="w-full bg-gray-200 rounded-full h-3">
                <div
                  class="progress-bar bg-gradient-to-r from-purple-500 to-indigo-600 h-3 rounded-full"
                  id="calorie-progress"
                  style="width: 0%"
                ></div>
              </div>
              <div class="text-right mt-1">
                <span class="text-sm font-medium" id="calories-remaining"
                  >&mdash;</span
                >
              </div>
            </div>
            <div class="grid grid-cols-3 gap-4 pt-4 border-t">
              <div class="text-center">
                <div class="text-2xl font-bold text-purple-600" id="today-protein">
                  0
                </div>
                <div class="text-xs text-gray-500">Белки (г)</div>
                <div class="text-xs text-gray-400" id="protein-target-label">
                  &mdash;
                </div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-amber-600" id="today-fats">
                  0
                </div>
                <div class="text-xs text-gray-500">Жиры (г)</div>
                <div class="text-xs text-gray-400" id="fats-target-label">
                  &mdash;
                </div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="today-carbs">
                  0
                </div>
                <div class="text-xs text-gray-500">Углеводы (г)</div>
                <div class="text-xs text-gray-400" id="carbs-target-label">
                  &mdash;
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="weight-tab" class="hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="glass-white rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">Добавить взвешивание</h3>
            <form id="weight-form" class="space-y-4">
              <div>
                <label class="block text-sm font-medium mb-2">Дата</label>
                <input
                  type="date"
                  id="weight-date"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                  required
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Время</label>
                <select
                  id="weight-time"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                >
                  <option value="morning">Утро</option>
                  <option value="evening">Вечер</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Вес (кг)</label>
                <input
                  type="number"
                  step="0.1"
                  id="weight-value"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                  placeholder="82.2"
                  required
                />
              </div>
              <button
                type="submit"
                class="w-full btn-primary text-white font-semibold py-3 rounded-lg"
              >
                Добавить
              </button>
            </form>
          </div>

          <div class="lg:col-span-2 glass-white rounded-xl p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">История взвешиваний</h3>
              <button
                id="btn-clear-weight"
                class="text-sm text-red-600 hover:text-red-700"
              >
                Очистить всё
              </button>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead>
                  <tr class="border-b">
                    <th class="text-left py-3 px-2">Дата</th>
                    <th class="text-left py-3 px-2">Время</th>
                    <th class="text-right py-3 px-2">Вес (кг)</th>
                    <th class="text-right py-3 px-2">Ожидаемый</th>
                    <th class="text-right py-3 px-2">Отклонение</th>
                    <th class="text-right py-3 px-2"></th>
                  </tr>
                </thead>
                <tbody id="weight-history"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div id="calories-tab" class="hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="glass-white rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">Добавить приём пищи</h3>
            <form id="meal-form" class="space-y-4">
              <div>
                <label class="block text-sm font-medium mb-2">Дата</label>
                <input
                  type="date"
                  id="meal-date"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                  required
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2"
                  >Приём пищи</label
                >
                <select
                  id="meal-type"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                >
                  <option value="Завтрак">Завтрак</option>
                  <option value="Перекус 1">Перекус 1</option>
                  <option value="Обед">Обед</option>
                  <option value="Перекус 2">Перекус 2</option>
                  <option value="Ужин">Ужин</option>
                  <option value="Перекус 3">Перекус 3</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Описание</label>
                <textarea
                  id="meal-description"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                  rows="2"
                  placeholder="Что вы съели?"
                ></textarea>
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Калории</label>
                <input
                  type="number"
                  id="meal-calories"
                  class="w-full px-4 py-2 rounded-lg border border-gray-300"
                  placeholder="0"
                  required
                />
              </div>
              <div class="grid grid-cols-3 gap-2">
                <div>
                  <label class="block text-xs font-medium mb-1"
                    >Белки (г)</label
                  >
                  <input
                    type="number"
                    step="0.1"
                    id="meal-protein"
                    class="w-full px-2 py-2 rounded-lg border border-gray-300 text-sm"
                    placeholder="0"
                  />
                </div>
                <div>
                  <label class="block text-xs font-medium mb-1"
                    >Жиры (г)</label
                  >
                  <input
                    type="number"
                    step="0.1"
                    id="meal-fats"
                    class="w-full px-2 py-2 rounded-lg border border-gray-300 text-sm"
                    placeholder="0"
                  />
                </div>
                <div>
                  <label class="block text-xs font-medium mb-1"
                    >Углев. (г)</label
                  >
                  <input
                    type="number"
                    step="0.1"
                    id="meal-carbs"
                    class="w-full px-2 py-2 rounded-lg border border-gray-300 text-sm"
                    placeholder="0"
                  />
                </div>
              </div>
              <button
                type="submit"
                class="w-full btn-primary text-white font-semibold py-3 rounded-lg"
              >
                Добавить
              </button>
            </form>
          </div>

          <div class="lg:col-span-2 glass-white rounded-xl p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">Приёмы пищи сегодня</h3>
              <div class="text-sm">
                <span class="font-semibold" id="meals-total-calories">0</span>
                /
                <span id="meals-calorie-target">&mdash;</span> ккал
              </div>
            </div>
            <div id="today-meals" class="space-y-2"></div>
            <div class="mt-4 pt-4 border-t">
              <div class="flex justify-between items-center">
                <span class="font-semibold">Осталось на сегодня:</span>
                <span class="text-2xl font-bold" id="meals-remaining"
                  >&mdash;</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="history-tab" class="hidden">
        <div class="glass-white rounded-xl p-6">
          <h3 class="text-xl font-bold mb-4">История по дням</h3>
          <div id="daily-history" class="space-y-4"></div>
        </div>
      </div>

      <div id="export-tab" class="hidden">
        <div class="glass-white rounded-xl p-6">
          <h3 class="text-xl font-bold mb-6">Экспорт данных</h3>
          <div class="space-y-4">
            <div class="p-4 bg-blue-50 rounded-lg">
              <h4 class="font-semibold mb-2">Экспорт в CSV</h4>
              <p class="text-sm text-gray-600 mb-4">
                Скачайте все данные в формате CSV для анализа в Excel или Google
                Sheets
              </p>
              <div class="space-y-2">
                <button
                  id="btn-export-weight"
                  class="w-full md:w-auto px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                >
                  Экспорт веса
                </button>
                <button
                  id="btn-export-calories"
                  class="w-full md:w-auto px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ml-0 md:ml-2"
                >
                  Экспорт калорий
                </button>
              </div>
            </div>
            <div class="p-4 bg-purple-50 rounded-lg">
              <h4 class="font-semibold mb-2">Резервная копия</h4>
              <p class="text-sm text-gray-600 mb-4">
                Сохраните все данные в JSON формате
              </p>
              <button
                id="btn-export-backup"
                class="w-full md:w-auto px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
              >
                Скачать бэкап
              </button>
            </div>
            <div class="p-4 bg-green-50 rounded-lg">
              <h4 class="font-semibold mb-2">Импорт данных</h4>
              <p class="text-sm text-gray-600 mb-4">
                Восстановите данные из резервной копии
              </p>
              <input
                type="file"
                id="import-file"
                accept=".json"
                class="hidden"
              />
              <button
                id="btn-import-backup"
                class="w-full md:w-auto px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
              >
                Загрузить бэкап
              </button>
            </div>
            <div class="p-4 bg-red-50 rounded-lg">
              <h4 class="font-semibold mb-2 text-red-700">
                Очистить все данные
              </h4>
              <p class="text-sm text-gray-600 mb-4">
                Удалить все данные приложения (необратимо)
              </p>
              <button
                id="btn-clear-all"
                class="w-full md:w-auto px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
              >
                Очистить всё
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
